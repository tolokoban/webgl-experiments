{"version":3,"sources":["equilaterals.js"],"names":["require","module","exports","_","GLOBAL","CODE_BEHIND","init","Base","canvas","$elements","$","gl","getContext","preserveDrawingBuffer","base","frag","PM","Tag","Link","View","Converters","TfwViewCheckbox","ensureCodeBehind","defVal","args","attName","attValue","undefined","addClassIfTrue","element","className","value","addClass","removeClass","conv_boolean","get","ViewClass","that","pm","create","cast","e_","e_canvas","e_1","e_2","content","wide","add","Object","defineProperty","writable","enumerable","configurable","A","obj","name","B","action","v","class","set","fire","call","ex","console","error","Error"],"mappings":"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","sourcesContent":["/** @module noise.equilaterals */require( 'noise.equilaterals', function(require, module, exports) { var _=function(){return ''}; const GLOBAL = {\n  \"vert\": \"attribute vec2 attXY;\\r\\n\\r\\nvoid main() {\\r\\n    gl_Position = vec4( attXY, 0, 1);\\r\\n}\\r\\n\",\n  \"frag\": \"#ifdef GL_ES\\r\\nprecision mediump float;\\r\\n#endif\\r\\n\\r\\n\\r\\nuniform float uniTime;\\r\\nuniform float uniCenterX;\\r\\nuniform float uniCenterY;\\r\\n\\r\\nconst vec3 COLOR0 = vec3(.7, 1, 0);\\r\\nconst vec3 COLOR1 = vec3(.3, 0, 1);\\r\\nconst vec3 COLOR2 = vec3(1, .4, 0);\\r\\nconst vec3 COLOR3 = vec3(0, 1, 1);\\r\\nconst vec3 COLOR4 = vec3(.7, .7, 0);\\r\\nconst vec3 COLOR5 = vec3(1, .3, .7);\\r\\nconst vec3 COLOR6 = vec3(1, 1, 0);\\r\\nconst vec3 COLOR7 = vec3(1, .7, .3);\\r\\n\\r\\nconst float ALPHA = sqrt(3.);\\r\\n\\r\\nvoid main() {\\r\\n  float ang = uniTime * 0.0001;\\r\\n  float c = cos( ang );\\r\\n  float s = sin( ang );\\r\\n  mat2 rotation = mat2(c, -s, s, c);\\r\\n  \\r\\n  vec2 coords = gl_FragCoord.xy - vec2( uniCenterX, uniCenterY );\\r\\n  \\r\\n  float zoom = 0.0075;\\r\\n  float t = mod( uniTime, 30000.0 );\\r\\n  float transition;\\r\\n  \\r\\n  if( t < 15000.0 ) transition = 0.0;\\r\\n  else if ( t < 20000.0 ) transition = smoothstep(15000.0, 20000.0, t);\\r\\n  else if ( t < 25000.0 ) transition = 1.0;\\r\\n  else transition = 1.0 - smoothstep(25000.0, 30000.0, t);\\r\\n  \\r\\n  float alpha = mix(ALPHA, 1.0, transition);\\r\\n  float sa = (1.0 + alpha);\\r\\n  float sb = (alpha - 1.0);\\r\\n  mat2 skew = mat2( sa, sb, sb, sa );\\r\\n  vec2 pos = skew * rotation * coords * zoom;\\r\\n  float x = pos.x;\\r\\n  float y = pos.y;\\r\\n\\r\\n  float u2 = fract(x * .5);\\r\\n  float v2 = fract(y * .5);\\r\\n  float u = fract(x);\\r\\n  float v = fract(y);\\r\\n\\r\\n  vec3 color;\\r\\n  \\r\\n  if( u2 < .5 ) {\\r\\n    if( v2 < .5 ) {\\r\\n      if( u < v ) color = COLOR0;\\r\\n      else color = COLOR1;\\r\\n    }\\r\\n    else {\\r\\n      if( u < v ) color = COLOR2;\\r\\n      else color = COLOR3;\\r\\n    }\\r\\n  }\\r\\n  else {\\r\\n    if( v2 < .5 ) {\\r\\n      if( u < v ) color = COLOR4;\\r\\n      else color = COLOR5;\\r\\n    }\\r\\n    else {\\r\\n      if( u < v ) color = COLOR6;\\r\\n      else color = COLOR7;\\r\\n    }\\r\\n  }\\r\\n\\r\\n  float grayscale = 0.2989 * color.r + 0.5870 * color.g + 0.1140 * color.b;\\r\\n  gl_FragColor = vec4( mix(color, vec3(grayscale, grayscale, grayscale), transition), 1 );\\r\\n\\r\\n  // Afficher la grande diagonale.\\r\\n  if( abs(u - v) < 0.04 ) gl_FragColor = vec4( gl_FragColor.rgb * 25. * abs( u - v), 1 );\\r\\n}\\r\\n\"};\n  \"use strict\";\r\n\r\n\r\n/* exported CODE_BEHIND */\r\nconst CODE_BEHIND = { init };\r\n\r\n\r\nconst Base = require(\"noise.base\");\r\n\r\n/**\r\n * @return {undefined}\r\n */\r\nfunction init(  ) {\r\n    const canvas = this.$elements.canvas.$,\r\n          gl = canvas.getContext(\"webgl\", { preserveDrawingBuffer: false }),\r\n          base = new Base( gl, GLOBAL.frag );\r\n}\r\n\n\n\n//===============================\n// XJS:View autogenerated code.\ntry {\n  module.exports = function() {\n    //--------------------\n    // Dependent modules.\n    const $ = require('dom');\n    const PM = require('tfw.binding.property-manager');\n    const Tag = require('tfw.view').Tag;\n    const Link = require('tfw.binding.link');\n    const View = require('tfw.view');;\n    const Converters = require('tfw.binding.converters');\n    const TfwViewCheckbox = require('tfw.view.checkbox');\n    //-------------------------------------------------------\n    // Check if needed functions are defined in code behind.\n    View.ensureCodeBehind( CODE_BEHIND, \"init\" );\n    //-------------------\n    // Global functions.\n    function defVal(args, attName, attValue) { return args[attName] === undefined ? attValue : args[attName]; };\n    function addClassIfTrue(element, className, value) {\n    if( value ) $.addClass(element, className);\n    else $.removeClass(element, className); };;\n    //-------------------\n    // Global variables.\n    const conv_boolean = Converters.get('boolean');\n    //-------------------\n    // Class definition.\n    const ViewClass = function( args ) {\n      try {\n        if( typeof args === 'undefined' ) args = {};\n        this.$elements = {};\n                const that = this;\n        const pm = PM(this);\n        //--------------------\n        // Create attributes.\n        pm.create(\"fullscreen\", { cast: conv_boolean });\n        //------------------\n        // Create elements.\n        const e_ = new Tag('DIV', [\"class\"]);\n        const e_canvas = new Tag('CANVAS');\n        this.$elements.canvas = e_canvas;\n        const e_1 = new Tag('DIV', [\"class\"]);\n        const e_2 = new TfwViewCheckbox({\n          content: \"Plein Ã©cran\",\n          wide: false\n        });\n        $.add( e_1, e_2 );\n        $.add( e_, e_canvas, e_1 );\n        //-----------------------\n        // Declare root element.\n        Object.defineProperty( this, '$', {\n          value: e_.$,\n          writable: false, \n          enumerable: false, \n          configurable: false\n        });\n        //-------\n        // Links\n        new Link({\n          A:{obj: that,\n              name: 'fullscreen'},\n          B:{action: function(v) {\n          addClassIfTrue( e_, \"fullscreen\", v );}},\n          name:\"fullscreen > undefined\"\n        });\n        new Link({\n          A:{obj: that,\n              name: 'fullscreen'},\n          B:{obj: e_2,\n              name: 'value'},\n          name:\"fullscreen > e_2/value\"\n        });\n        //----------------------\n        // Initialize elements.\n        e_.class = \"noise-equilaterals\";\n        e_1.class = \"bottom\";\n        //------------------------\n        // Initialize attributes.\n        pm.set(\"fullscreen\", defVal(args, \"fullscreen\", false));\n        pm.fire(\"fullscreen\");\n        // Initialization.\n        CODE_BEHIND.init.call( this );\n        $.addClass(this, 'view', 'custom');\n\n      }\n      catch( ex ) {\n        console.error('mod/noise.equilaterals.js', ex);\n        throw Error('Instantiation error in XJS of \"mod/noise.equilaterals.js\":\\n' + ex)\n      }\n    };\n    return ViewClass;\n  }();\n}\ncatch( ex ) {\n  throw Error('Definition error in XJS of \"mod/noise.equilaterals.js\"\\n' + ex);\n}\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}