"use strict";require("tfw.binding.list",function(require,module){function isAlreadySorted(array,comparator){if(2>array.length)return!0;for(var current,previous=array[0],k=1;k<array.length;k++){if(current=array[k],0<comparator(previous,current))return!1;previous=current}return!0}function isList(candidate){return!!candidate&&"number"==typeof candidate["__tfw.binding.list__"]}function readOnly(object,attrib,value){Object.defineProperty(object,attrib,{value:value,writable:!1,configurable:!1,enumerable:!0})}var _=function(){function _(){return X(D,arguments)}var D={en:{},fr:{}},X=require("$").intl;return _.all=D,_}();var PM=require("tfw.binding.property-manager"),Listeners=require("tfw.listeners"),ID="__tfw.binding.list__",COUNT=1,List=function(arg){readOnly(this,ID,COUNT++),readOnly(this,"_listeners",new Listeners),readOnly(this,"_links",[]),readOnly(this,"isContentChangeAware",!0),Array.isArray(arg)?readOnly(this,"_array",arg):isList(arg)?(readOnly(this,"_array",arg._array),this.link(arg)):readOnly(this,"_array",[arg])};module.exports=List,List.isList=isList,List.prototype.fire=function(functionName,args,wave){var id=this[ID];Array.isArray(wave)?-1===wave.indexOf(id)&&wave.push(id):wave=[id],this._listeners.fire(functionName,args,wave),this._links.forEach(function(list){-1<wave.indexOf(list[ID])||list.fire(functionName,args,wave)});var properties=PM.getProperties(this);Array.isArray(properties)&&properties.forEach(function(prop){prop.manager.fire(prop.name)})},List.prototype.addListener=function(listener){this._listeners.add(listener)},List.prototype.removeListener=function(listener){this._listeners.remove(listener)},List.prototype.link=function(list){if(!isList(list))throw console.error("Argument: ",list),Error("[tfw.binding.list.link] Argument must be a tfw.binding.list object!");-1===this._links.indexOf(list)&&(this._links.push(list),list.link(this))},List.prototype.unlink=function(list){var index=this._links.indexOf(list);-1===index||(this._links.splice(index,1),list.unlink(this))},List.prototype.get=function(index){return this._array[index]},List.prototype.put=function(index,newValue){var oldValue=this._array[index];return oldValue!==newValue&&(this._array[index]=newValue,this.fire("put",{index:index,oldValue:oldValue,newValue:newValue}),!0)},List.prototype.remove=function(elem){var index=this._array.indexOf(elem);return-1!==index&&(this._array.splice(index,1),this.fire("remove",{elem:elem,index:index}),!0)},List.prototype.removeAt=function(index){var elem=this._array[index];return this._array.splice(index,1),this.fire("remove",{elem:elem,index:index}),!0},List.prototype.mapInPlace=function(func){var that=this;return this._Array.forEach(function(itm,idx){var newValue=func(itm);that.put(idx,newValue)}),this};var DEFAULT_COMPARATOR=function(a,b){return a==b?0:a<b?-1:1};List.prototype.sort=function(comparator){return("function"!=typeof comparator&&(comparator=DEFAULT_COMPARATOR),isAlreadySorted(this._array,comparator))?this:(this._array.sort(comparator),this.fire("sort",comparator),this)},["push","pop","shift","unshift","splice","reverse"].forEach(function(funcName){List.prototype[funcName]=function(){var args=Array.prototype.slice.call(arguments),result=Array.prototype[funcName].apply(this._array,args);return this.fire(funcName,args),result}}),["slice","forEach","filter","map","reduce","indexOf","lastIndexOf"].forEach(function(funcName){List.prototype[funcName]=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return Array.prototype[funcName].apply(this._array,args)}}),Array.prototype.includes||(Array.prototype.includes=function(item){return-1!==this.indexOf(item)}),List.prototype.includes=function(item){return Array.prototype.includes.call(this._array,item)},Object.defineProperty(List.prototype,"length",{get:function get(){return this._array.length},set:function set(v){this._array.length=v,this.fire("length",v)},configurable:!1,enumerable:!0}),module.exports._=_});
//# sourceMappingURL=tfw.binding.list.js.map