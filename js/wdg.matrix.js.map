{"version":3,"sources":["wdg.matrix.js"],"names":["require","module","exports","_","D","X","intl","arguments","all","$","Matrix","arg","v","value","trim","body","div","element","ctx","parent","cursor","text","parse","length","c","charAt","parseMatrix","parseTimes","parseSymbol","child","textContent","appendChild","innerHTML","mat","row","cell"],"mappings":"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","sourcesContent":["/** @module wdg.matrix */require( 'wdg.matrix', function(require, module, exports) { var _=function(){var D={\"en\":{},\"fr\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   \"use strict\";\r\n\r\nvar $ = require(\"dom\");\r\n\r\n\r\nvar Matrix = function(arg) {\r\n  if( typeof arg === 'undefined' ) arg = \"\";\r\n  var v = (\"\" + arg.value).trim();\r\n\r\n  var body = $.div(\"wdg-matrix\");\r\n  this.element = body;\r\n  var ctx = {\r\n    parent: body,\r\n    cursor: 0,\r\n    text: v\r\n  };\r\n  while( parse(ctx) );\r\n};\r\n\r\n\r\nfunction parse( ctx ) {\r\n  if( ctx.text.length <= ctx.cursor ) return false;\r\n  var c = ctx.text.charAt( ctx.cursor++ ).trim();\r\n  if( c.length === 0 ) return true;\r\n  if( c === '[' ) return parseMatrix( ctx );\r\n  if( c === '*' ) return parseTimes( ctx );  \r\n  return parseSymbol( c, ctx );\r\n}\r\n\r\nfunction parseSymbol( c, ctx ) {\r\n  var child = $.div();\r\n  child.textContent = c;\r\n  ctx.parent.appendChild( child );\r\n  return true;\r\n}\r\n\r\nfunction parseTimes( ctx ) {\r\n  var child = $.div();\r\n  child.innerHTML = '&times;';\r\n  ctx.parent.appendChild( child );\r\n  return true;\r\n}\r\n\r\nfunction parseMatrix( ctx ) {\r\n  var mat = $.div(\"mtx\");\r\n  var row = $.div();\r\n  var cell = $.div();\r\n\r\n  mat.appendChild( row );\r\n  row.appendChild( cell );\r\n  \r\n  while( ctx.cursor < ctx.text.length ) {\r\n    var c = ctx.text.charAt( ctx.cursor++ ).trim();\r\n    if( c === ']' ) break;\r\n    if( c === ',' ) {\r\n      cell = $.div();\r\n      row.appendChild( cell );      \r\n    }\r\n    else if( c === ';' ) {\r\n      row = $.div();\r\n      mat.appendChild( row );\r\n      cell = $.div();\r\n      row.appendChild( cell );      \r\n    }\r\n    else if( c === '*' ) {\r\n      cell.innerHTML += \"&times;\";\r\n    }\r\n    else {\r\n      cell.textContent += c;\r\n    }\r\n  }\r\n  ctx.parent.appendChild( mat );\r\n  return true;\r\n}\r\n\r\nmodule.exports = Matrix;\r\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}