{"version":3,"sources":["tfw.gestures.js"],"names":["require","module","exports","_","D","X","intl","arguments","all","getGesture","HANDLERS","tap","onTap","doubletap","onDoubletap","drag","onDrag","dragstart","onDragStart","dragend","onDragEnd","move","onMove","down","onDown","up","onUp","wheel","onWheel","SYMBOL","Symbol","WHEEL_EVENT","document","createElement","onmousewheel","SUPPORTED_EVENTS","Object","keys","Hammer","Gesture","element","defineProperty","writable","value","configurable","_events","_touchstart","arg1","arg2","arg3","syntax1","name","slot","args","ensureValidGestureNameAndSlot","call","doRegister","bind","ex","console","error","Error","element_","ensureDom","handlerWithChainOfResponsability","eventName","evt","chain","i","length","responsible","event","hammerEvent","getEventNameForPrefix","_hammer","$","domEvents","eventDef","handler","on","addEventListener","push","JSON","indexOf","join","dom","Node","undefined","elem","getElementById","setHammerXY","x","y","center","rect","getBoundingClientRect","left","top","setXY","clientX","clientY","setHammerVxVy","vx","_dragX","vy","_dragY","x0","deltaX","y0","deltaY","register","that","tapCount","target","preventDefault","newEvt","delta","wheelDelta","stopPropagation","isFinal","_dragStart","domEvt","srcEvent","sx","velocityX","sy","velocityY","buttons","getButtons","stopImmediatePropagation","log","changedTouches","touch","now","Date","text","prefix","substr"],"mappings":"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","sourcesContent":["/** @module tfw.gestures */require( 'tfw.gestures', function(require, module, exports) { var _=function(){var D={\"en\":{},\"fr\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   \"use strict\";\r\n\r\n/**\r\n * @param {dom} element\r\n * @param {function} events - Shortcut for `{ tap: ... }`.\r\n * @param {function} events.tap { x, y }\r\n * @param {function} events.doubletap { x, y }\r\n * @param {function} events.drag { x, y, x0, y0, vx, vy }\r\n * @param {function} events.dragstart { x, y }\r\n * @param {function} events.dragend { x, y, x0, y0 }\r\n * @param {function} events.wheel { x, y, delta }\r\n */\r\nmodule.exports = getGesture;\r\n\r\nconst\r\n    HANDLERS = {\r\n        tap: onTap,\r\n        doubletap: onDoubletap,\r\n        drag: onDrag,\r\n        dragstart: onDragStart,\r\n        dragend: onDragEnd,\r\n        move: onMove,\r\n        down: onDown,\r\n        up: onUp,\r\n        wheel: onWheel\r\n    },\r\n    SYMBOL = Symbol( '__tfw.gestures__' ),\r\n    // Webkit and Opera still use 'mousewheel' event type.\r\n    WHEEL_EVENT = ( function () {\r\n        // Modern browsers support \"wheel\"\r\n        if ( \"onwheel\" in document.createElement( \"div\" ) ) return \"wheel\";\r\n        // Webkit and IE support at least \"mousewheel\"\r\n        if ( typeof document.onmousewheel !== 'undefined' ) return \"mousewheel\";\r\n        // let's assume that remaining browsers are older Firefox\r\n        return \"DOMMouseScroll\";\r\n    }() ),\r\n    SUPPORTED_EVENTS = Object.keys( HANDLERS );\r\n\r\nconst Hammer = require( \"external.hammer\" );\r\n\r\n\r\nclass Gesture {\r\n    constructor( element ) {\r\n        Object.defineProperty( this, '$', { writable: false, value: element, configurable: false } );\r\n        this._events = {};\r\n        // Last time  a touch  start occurs.  This  is used to  prevent onmousedown  to be triggered  if a\r\n        // touchstart has been processed.\r\n        this._touchstart = 0;\r\n    }\r\n\r\n    /**\r\n     * Two syntaxes: on( name, slot, args) or on( slot, args ).\r\n     * In the second case, name is 'tap'.\r\n     *\r\n     * @param   {string|function} arg1 - name or slot.\r\n     * @param   {function|any} arg2 - slot or args.\r\n     * @param   {any} arg3 - args or undefined.\r\n     * @returns {object} this.\r\n     */\r\n    on( arg1, arg2, arg3 ) {\r\n        const\r\n            syntax1 = typeof arg1 === 'function',\r\n            name = syntax1 ? \"tap\" : arg1,\r\n            slot = syntax1 ? arg1 : arg2,\r\n            args = syntax1 ? arg2 : arg3;\r\n        try {\r\n            ensureValidGestureNameAndSlot( name, slot );\r\n            HANDLERS[ name ].call( this, doRegister.bind( this ), slot, args );\r\n            return this;\r\n        } catch ( ex ) {\r\n            console.error( \"[Gesture.on( name, slot, args )]\" );\r\n            console.error( \"   name\", name );\r\n            console.error( \"   slot\", slot );\r\n            console.error( \"   args\", args );\r\n            console.error( \"   ERROR\", ex );\r\n            throw Error( ex );\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Return the associated gesture object. If it does not exist, create it.\r\n *\r\n * @param   {[type]} element_ [description]\r\n * @returns {[type]}         [description]\r\n */\r\nfunction getGesture( element_ ) {\r\n    const element = ensureDom( element_ );\r\n    if ( !element[ SYMBOL ] ) element[ SYMBOL ] = new Gesture( element );\r\n    return element[ SYMBOL ];\r\n}\r\n\r\n/**\r\n * We map a chain of responsability to each hammer event we need to deal with.\r\n * When an item  of that chain returns `true` that  means it will take the responsability  and we do\r\n * not ask the others.\r\n */\r\nfunction handlerWithChainOfResponsability( eventName, evt ) {\r\n    const chain = this._events[ eventName ].chain;\r\n    for ( let i = 0; i < chain.length; i++ ) {\r\n        const responsible = chain[ i ];\r\n        if ( responsible( evt ) === true ) return;\r\n    }\r\n}\r\n\r\n/**\r\n * Add a responsability item in the chain of a hammer event.\r\n */\r\nfunction doRegister( event, responsible ) {\r\n    var hammerEvent = getEventNameForPrefix( event, \"hammer.\" );\r\n    if ( hammerEvent && !this._hammer ) {\r\n        this._hammer = new Hammer( this.$, { domEvents: true } );\r\n        // To get domEvents.stopPropagation() available.\r\n        this._hammer.domEvents = true;\r\n    }\r\n\r\n    var eventDef = this._events[ event ];\r\n    if ( !eventDef ) {\r\n        var handler = handlerWithChainOfResponsability.bind( this, event );\r\n        eventDef = { chain: [], handler: handler };\r\n        if ( hammerEvent ) this._hammer.on( hammerEvent, handler );\r\n        else this.$.addEventListener( event, handler );\r\n        this._events[ event ] = eventDef;\r\n    }\r\n    eventDef.chain.push( responsible );\r\n}\r\n\r\n\r\nfunction ensureValidGestureNameAndSlot( name, slot ) {\r\n    if ( typeof name !== 'string' ) {\r\n        throw Error( \"[Gestures.on] `name` must be a string: \" + JSON( name ) + \"!\" );\r\n    }\r\n    if ( SUPPORTED_EVENTS.indexOf( name ) === -1 ) {\r\n        throw Error( \"Unknown gesture's name `\" + name + \"`!\\n\" +\r\n            \"Available names are: \" + SUPPORTED_EVENTS.join( \", \" ) + \".\" );\r\n    }\r\n    if ( typeof slot !== 'function' ) {\r\n        throw Error( \"Gesture `\" + name + \"` must have a function as slot!\" );\r\n    }\r\n}\r\n\r\n\r\nfunction ensureDom( dom ) {\r\n    if ( dom instanceof Node ) return dom;\r\n    if ( dom === undefined || dom === null ) {\r\n        throw Error( \"Not a valid DOM element!\", dom );\r\n    }\r\n    if ( dom.$ instanceof Node ) return dom.$;\r\n    if ( dom.element instanceof Node ) return dom.element;\r\n    if ( typeof dom === 'string' ) {\r\n        var elem = document.getElementById( dom );\r\n        if ( !elem ) {\r\n            console.error( \"There is no DOM element with this ID: `\" + dom + \"`\" );\r\n        }\r\n        return elem;\r\n    }\r\n    if ( typeof dom.element === 'function' ) return dom.element();\r\n    return dom;\r\n};\r\n\r\n\r\nfunction setHammerXY( elem, evt ) {\r\n    var x, y;\r\n    // Hammer's attributes.\r\n    x = evt.center.x;\r\n    y = evt.center.y;\r\n    var rect = elem.getBoundingClientRect();\r\n    evt.x = x - rect.left;\r\n    evt.y = y - rect.top;\r\n}\r\n\r\nfunction setXY( elem, evt ) {\r\n    var x, y;\r\n    // Browser's attributes.\r\n    x = evt.clientX;\r\n    y = evt.clientY;\r\n    var rect = elem.getBoundingClientRect();\r\n    return {\r\n        x: x - rect.left,\r\n        y: y - rect.top\r\n    };\r\n}\r\n\r\nfunction setHammerVxVy( elem, evt ) {\r\n    evt.vx = evt.x - this._dragX;\r\n    evt.vy = evt.y - this._dragY;\r\n    evt.x0 = evt.x - evt.deltaX;\r\n    evt.y0 = evt.y - evt.deltaY;\r\n    this._dragX = evt.x;\r\n    this._dragY = evt.y;\r\n}\r\n\r\n\r\nfunction onTap( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.tap', function ( evt ) {\r\n        if ( evt.tapCount !== 1 ) return false;\r\n        setHammerXY( that.$, evt );\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: evt.preventDefault.bind( evt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\nfunction onDoubletap( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.tap', function ( evt ) {\r\n        if ( evt.tapCount !== 2 ) return false;\r\n        setHammerXY( that.$, evt );\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: evt.preventDefault.bind( evt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\nfunction onWheel( register, slot, args ) {\r\n    var that = this;\r\n    register( WHEEL_EVENT, function ( evt ) {\r\n        var newEvt = setXY( that.$, evt );\r\n        newEvt.delta = evt.deltaY;\r\n        if ( typeof newEvt.delta !== 'number' ) {\r\n            // IE 11.\r\n            newEvt.delta = -evt.wheelDelta;\r\n        }\r\n        newEvt.preventDefault = evt.preventDefault.bind( evt );\r\n        newEvt.stopPropagation = evt.stopPropagation.bind( evt );\r\n        slot( newEvt );\r\n    } );\r\n}\r\n\r\nfunction onMove( register, slot ) {\r\n    var that = this;\r\n    register( 'mousemove', function ( evt ) {\r\n        var newEvt = setXY( that.$, evt );\r\n        newEvt.preventDefault = evt.preventDefault.bind( evt );\r\n        newEvt.stopPropagation = evt.stopPropagation.bind( evt );\r\n        newEvt.event = evt;\r\n        slot( newEvt );\r\n    } );\r\n}\r\n\r\n/**\r\n * Dragging is moving while touching.\r\n *\r\n * @this Gesture\r\n * @param   {function} register - Hammer register function.\r\n * @param   {function} slot - Function to call when the event occurs.\r\n * @param   {any} args - Any argument to send to the slot.\r\n * @returns {undefined}\r\n */\r\nfunction onDrag( register, slot, args ) {\r\n    const that = this;\r\n\r\n    register( 'hammer.pan', function ( evt ) {\r\n        if ( evt.isFinal ) return false;\r\n        setHammerXY( that.$, evt );\r\n        if ( typeof that._dragX === 'undefined' ) {\r\n            that._dragX = evt.x;\r\n            that._dragY = evt.y;\r\n            that._dragStart = true;\r\n        }\r\n        setHammerVxVy.call( that, that.$, evt );\r\n        const domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            x0: evt.x0,\r\n            y0: evt.y0,\r\n            vx: evt.vx,\r\n            vy: evt.vy,\r\n            sx: evt.velocityX,\r\n            sy: evt.velocityY,\r\n            event: evt,\r\n            target: evt.target,\r\n            buttons: getButtons( evt ),\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        }, args );\r\n        return true;\r\n    } );\r\n}\r\n\r\n/**\r\n * Get the information on buttons pressed.\r\n * This is a cumulative value because several buttons can be pressed at the same time:\r\n *   1: left mouse button.\r\n *   2: right mouse button.\r\n *   4: middle mouse button.\r\n * Then, if the result is 3 (1+2), it means that the left and the right mouse buttons are pressed.\r\n *\r\n * @param {object} hammerEvent - Hammer event.\r\n * @param {integer} hammerEvent.srcEvent.buttons - The information we need.\r\n * @returns {integer} A betwise OR of the pressed buttons.\r\n */\r\nfunction getButtons( hammerEvent ) {\r\n    if ( !hammerEvent || !hammerEvent.srcEvent ) return 0;\r\n    const buttons = hammerEvent.srcEvent.buttons;\r\n    if ( typeof buttons === 'number' ) return buttons;\r\n    return 0;\r\n}\r\n\r\nfunction onDragEnd( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.panend', function ( evt ) {\r\n        setHammerXY( that.$, evt );\r\n        setHammerVxVy.call( that, that.$, evt );\r\n        var domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            x0: evt.x0,\r\n            y0: evt.y0,\r\n            target: evt.target,\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        } );\r\n        delete that._dragX;\r\n        delete that._dragY;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onDragStart( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.panstart', function ( evt ) {\r\n        console.log( \"START\" );\r\n        setHammerXY.call( that, that.$, evt );\r\n        var domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onDown( register, slot, args ) {\r\n    var that = this;\r\n    register( \"touchstart\", function ( evt ) {\r\n        if ( !evt.changedTouches || evt.changedTouches.length < 1 ) return false;\r\n        var touch = evt.changedTouches[ 0 ];\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: touch.clientX - rect.left,\r\n                y: touch.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        return true;\r\n    } );\r\n    register( \"mousedown\", function ( evt ) {\r\n        var now = Date.now();\r\n        if ( now - that._touchstart < 350 ) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            return false;\r\n        }\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: evt.clientX - rect.left,\r\n                y: evt.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = 0;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onUp( register, slot, args ) {\r\n    var that = this;\r\n    register( \"touchend\", function ( evt ) {\r\n        if ( !evt.changedTouches || evt.changedTouches.length < 1 ) return false;\r\n        var touch = evt.changedTouches[ 0 ];\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: touch.clientX - rect.left,\r\n                y: touch.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = Date.now();\r\n        return true;\r\n    } );\r\n    register( \"mouseup\", function ( evt ) {\r\n        if ( that._touchstart > 0 ) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            return false;\r\n        }\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: evt.clientX - rect.left,\r\n                y: evt.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = 0;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction getEventNameForPrefix( text, prefix ) {\r\n    if ( text.substr( 0, prefix.length ) == prefix ) {\r\n        return text.substr( prefix.length );\r\n    }\r\n    return null;\r\n}\r\n\r\n\r\nmodule.exports._ = _;\n})"]}