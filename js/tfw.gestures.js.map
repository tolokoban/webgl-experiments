{"version":3,"sources":["tfw.gestures.js"],"names":["require","module","handlerWithChainOfResponsability","eventName","evt","responsible","chain","_events","i","length","doRegister","event","hammerEvent","getEventNameForPrefix","_hammer","Hammer","$","domEvents","eventDef","handler","bind","on","addEventListener","push","ensureValidGestureNameAndSlot","name","slot","Error","JSON","SUPPORTED_EVENTS","indexOf","join","ensureDom","dom","Node","element","elem","document","getElementById","console","error","setHammerXY","x","y","center","rect","getBoundingClientRect","left","top","setXY","clientX","clientY","setHammerVxVy","vx","_dragX","vy","_dragY","x0","deltaX","y0","deltaY","getButtons","srcEvent","buttons","text","prefix","substr","_","X","D","arguments","intl","all","exports","element_","SYMBOL","Gesture","HANDLERS","tap","register","that","tapCount","target","preventDefault","doubletap","drag","args","isFinal","_dragStart","call","domEvt","sx","velocityX","sy","velocityY","stopPropagation","stopImmediatePropagation","dragstart","log","dragend","move","newEvt","down","changedTouches","touch","ex","now","Date","_touchstart","up","wheel","WHEEL_EVENT","delta","wheelDelta","Symbol","createElement","onmousewheel","Object","keys","defineProperty","writable","value","configurable","arg1","arg2","arg3","syntax1"],"mappings":"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","sourcesContent":["/** @module tfw.gestures */require( 'tfw.gestures', function(require, module, exports) { var _=function(){var D={\"en\":{},\"fr\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   \"use strict\";\r\n\r\n/**\r\n * @param {dom} element\r\n * @param {function} events - Shortcut for `{ tap: ... }`.\r\n * @param {function} events.tap { x, y }\r\n * @param {function} events.doubletap { x, y }\r\n * @param {function} events.drag { x, y, x0, y0, vx, vy }\r\n * @param {function} events.dragstart { x, y }\r\n * @param {function} events.dragend { x, y, x0, y0 }\r\n * @param {function} events.wheel { x, y, delta }\r\n */\r\nmodule.exports = getGesture;\r\n\r\nconst\r\n    HANDLERS = {\r\n        tap: onTap,\r\n        doubletap: onDoubletap,\r\n        drag: onDrag,\r\n        dragstart: onDragStart,\r\n        dragend: onDragEnd,\r\n        move: onMove,\r\n        down: onDown,\r\n        up: onUp,\r\n        wheel: onWheel\r\n    },\r\n    SYMBOL = Symbol( '__tfw.gestures__' ),\r\n    // Webkit and Opera still use 'mousewheel' event type.\r\n    WHEEL_EVENT = ( function () {\r\n        // Modern browsers support \"wheel\"\r\n        if ( \"onwheel\" in document.createElement( \"div\" ) ) return \"wheel\";\r\n        // Webkit and IE support at least \"mousewheel\"\r\n        if ( typeof document.onmousewheel !== 'undefined' ) return \"mousewheel\";\r\n        // let's assume that remaining browsers are older Firefox\r\n        return \"DOMMouseScroll\";\r\n    }() ),\r\n    SUPPORTED_EVENTS = Object.keys( HANDLERS );\r\n\r\nconst Hammer = require( \"external.hammer\" );\r\n\r\n\r\nclass Gesture {\r\n    constructor( element ) {\r\n        Object.defineProperty( this, '$', { writable: false, value: element, configurable: false } );\r\n        this._events = {};\r\n        // Last time  a touch  start occurs.  This  is used to  prevent onmousedown  to be triggered  if a\r\n        // touchstart has been processed.\r\n        this._touchstart = 0;\r\n    }\r\n\r\n    /**\r\n     * Two syntaxes: on( name, slot, args) or on( slot, args ).\r\n     * In the second case, name is 'tap'.\r\n     *\r\n     * @param   {string|function} arg1 - name or slot.\r\n     * @param   {function|any} arg2 - slot or args.\r\n     * @param   {any} arg3 - args or undefined.\r\n     * @returns {object} this.\r\n     */\r\n    on( arg1, arg2, arg3 ) {\r\n        const\r\n            syntax1 = typeof arg1 === 'function',\r\n            name = syntax1 ? \"tap\" : arg1,\r\n            slot = syntax1 ? arg1 : arg2,\r\n            args = syntax1 ? arg2 : arg3;\r\n        try {\r\n            ensureValidGestureNameAndSlot( name, slot );\r\n            HANDLERS[ name ].call( this, doRegister.bind( this ), slot, args );\r\n            return this;\r\n        } catch ( ex ) {\r\n            console.error( \"[Gesture.on( name, slot, args )]\" );\r\n            console.error( \"   name\", name );\r\n            console.error( \"   slot\", slot );\r\n            console.error( \"   args\", args );\r\n            console.error( \"   ERROR\", ex );\r\n            throw Error( ex );\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Return the associated gesture object. If it does not exist, create it.\r\n *\r\n * @param   {[type]} element_ [description]\r\n * @returns {[type]}         [description]\r\n */\r\nfunction getGesture( element_ ) {\r\n    const element = ensureDom( element_ );\r\n    if ( !element[ SYMBOL ] ) element[ SYMBOL ] = new Gesture( element );\r\n    return element[ SYMBOL ];\r\n}\r\n\r\n/**\r\n * We map a chain of responsability to each hammer event we need to deal with.\r\n * When an item  of that chain returns `true` that  means it will take the responsability  and we do\r\n * not ask the others.\r\n */\r\nfunction handlerWithChainOfResponsability( eventName, evt ) {\r\n    const chain = this._events[ eventName ].chain;\r\n    for ( let i = 0; i < chain.length; i++ ) {\r\n        const responsible = chain[ i ];\r\n        if ( responsible( evt ) === true ) return;\r\n    }\r\n}\r\n\r\n/**\r\n * Add a responsability item in the chain of a hammer event.\r\n */\r\nfunction doRegister( event, responsible ) {\r\n    var hammerEvent = getEventNameForPrefix( event, \"hammer.\" );\r\n    if ( hammerEvent && !this._hammer ) {\r\n        this._hammer = new Hammer( this.$, { domEvents: true } );\r\n        // To get domEvents.stopPropagation() available.\r\n        this._hammer.domEvents = true;\r\n    }\r\n\r\n    var eventDef = this._events[ event ];\r\n    if ( !eventDef ) {\r\n        var handler = handlerWithChainOfResponsability.bind( this, event );\r\n        eventDef = { chain: [], handler: handler };\r\n        if ( hammerEvent ) this._hammer.on( hammerEvent, handler );\r\n        else this.$.addEventListener( event, handler );\r\n        this._events[ event ] = eventDef;\r\n    }\r\n    eventDef.chain.push( responsible );\r\n}\r\n\r\n\r\nfunction ensureValidGestureNameAndSlot( name, slot ) {\r\n    if ( typeof name !== 'string' ) {\r\n        throw Error( \"[Gestures.on] `name` must be a string: \" + JSON( name ) + \"!\" );\r\n    }\r\n    if ( SUPPORTED_EVENTS.indexOf( name ) === -1 ) {\r\n        throw Error( \"Unknown gesture's name `\" + name + \"`!\\n\" +\r\n            \"Available names are: \" + SUPPORTED_EVENTS.join( \", \" ) + \".\" );\r\n    }\r\n    if ( typeof slot !== 'function' ) {\r\n        throw Error( \"Gesture `\" + name + \"` must have a function as slot!\" );\r\n    }\r\n}\r\n\r\n\r\nfunction ensureDom( dom ) {\r\n    if ( dom instanceof Node ) return dom;\r\n    if ( dom === undefined || dom === null ) {\r\n        throw Error( \"Not a valid DOM element!\", dom );\r\n    }\r\n    if ( dom.$ instanceof Node ) return dom.$;\r\n    if ( dom.element instanceof Node ) return dom.element;\r\n    if ( typeof dom === 'string' ) {\r\n        var elem = document.getElementById( dom );\r\n        if ( !elem ) {\r\n            console.error( \"There is no DOM element with this ID: `\" + dom + \"`\" );\r\n        }\r\n        return elem;\r\n    }\r\n    if ( typeof dom.element === 'function' ) return dom.element();\r\n    return dom;\r\n};\r\n\r\n\r\nfunction setHammerXY( elem, evt ) {\r\n    var x, y;\r\n    // Hammer's attributes.\r\n    x = evt.center.x;\r\n    y = evt.center.y;\r\n    var rect = elem.getBoundingClientRect();\r\n    evt.x = x - rect.left;\r\n    evt.y = y - rect.top;\r\n}\r\n\r\nfunction setXY( elem, evt ) {\r\n    var x, y;\r\n    // Browser's attributes.\r\n    x = evt.clientX;\r\n    y = evt.clientY;\r\n    var rect = elem.getBoundingClientRect();\r\n    return {\r\n        x: x - rect.left,\r\n        y: y - rect.top\r\n    };\r\n}\r\n\r\nfunction setHammerVxVy( elem, evt ) {\r\n    evt.vx = evt.x - this._dragX;\r\n    evt.vy = evt.y - this._dragY;\r\n    evt.x0 = evt.x - evt.deltaX;\r\n    evt.y0 = evt.y - evt.deltaY;\r\n    this._dragX = evt.x;\r\n    this._dragY = evt.y;\r\n}\r\n\r\n\r\nfunction onTap( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.tap', function ( evt ) {\r\n        if ( evt.tapCount !== 1 ) return false;\r\n        setHammerXY( that.$, evt );\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: evt.preventDefault.bind( evt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\nfunction onDoubletap( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.tap', function ( evt ) {\r\n        if ( evt.tapCount !== 2 ) return false;\r\n        setHammerXY( that.$, evt );\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: evt.preventDefault.bind( evt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\nfunction onWheel( register, slot, args ) {\r\n    var that = this;\r\n    register( WHEEL_EVENT, function ( evt ) {\r\n        var newEvt = setXY( that.$, evt );\r\n        newEvt.delta = evt.deltaY;\r\n        if ( typeof newEvt.delta !== 'number' ) {\r\n            // IE 11.\r\n            newEvt.delta = -evt.wheelDelta;\r\n        }\r\n        newEvt.preventDefault = evt.preventDefault.bind( evt );\r\n        newEvt.stopPropagation = evt.stopPropagation.bind( evt );\r\n        slot( newEvt );\r\n    } );\r\n}\r\n\r\nfunction onMove( register, slot ) {\r\n    var that = this;\r\n    register( 'mousemove', function ( evt ) {\r\n        var newEvt = setXY( that.$, evt );\r\n        newEvt.preventDefault = evt.preventDefault.bind( evt );\r\n        newEvt.stopPropagation = evt.stopPropagation.bind( evt );\r\n        newEvt.event = evt;\r\n        slot( newEvt );\r\n    } );\r\n}\r\n\r\n/**\r\n * Dragging is moving while touching.\r\n *\r\n * @this Gesture\r\n * @param   {function} register - Hammer register function.\r\n * @param   {function} slot - Function to call when the event occurs.\r\n * @param   {any} args - Any argument to send to the slot.\r\n * @returns {undefined}\r\n */\r\nfunction onDrag( register, slot, args ) {\r\n    const that = this;\r\n\r\n    register( 'hammer.pan', function ( evt ) {\r\n        if ( evt.isFinal ) return false;\r\n        setHammerXY( that.$, evt );\r\n        if ( typeof that._dragX === 'undefined' ) {\r\n            that._dragX = evt.x;\r\n            that._dragY = evt.y;\r\n            that._dragStart = true;\r\n        }\r\n        setHammerVxVy.call( that, that.$, evt );\r\n        const domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            x0: evt.x0,\r\n            y0: evt.y0,\r\n            vx: evt.vx,\r\n            vy: evt.vy,\r\n            sx: evt.velocityX,\r\n            sy: evt.velocityY,\r\n            event: evt,\r\n            target: evt.target,\r\n            buttons: getButtons( evt ),\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        }, args );\r\n        return true;\r\n    } );\r\n}\r\n\r\n/**\r\n * Get the information on buttons pressed.\r\n * This is a cumulative value because several buttons can be pressed at the same time:\r\n *   1: left mouse button.\r\n *   2: right mouse button.\r\n *   4: middle mouse button.\r\n * Then, if the result is 3 (1+2), it means that the left and the right mouse buttons are pressed.\r\n *\r\n * @param {object} hammerEvent - Hammer event.\r\n * @param {integer} hammerEvent.srcEvent.buttons - The information we need.\r\n * @returns {integer} A betwise OR of the pressed buttons.\r\n */\r\nfunction getButtons( hammerEvent ) {\r\n    if ( !hammerEvent || !hammerEvent.srcEvent ) return 0;\r\n    const buttons = hammerEvent.srcEvent.buttons;\r\n    if ( typeof buttons === 'number' ) return buttons;\r\n    return 0;\r\n}\r\n\r\nfunction onDragEnd( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.panend', function ( evt ) {\r\n        setHammerXY( that.$, evt );\r\n        setHammerVxVy.call( that, that.$, evt );\r\n        var domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            x0: evt.x0,\r\n            y0: evt.y0,\r\n            target: evt.target,\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        } );\r\n        delete that._dragX;\r\n        delete that._dragY;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onDragStart( register, slot, args ) {\r\n    var that = this;\r\n\r\n    register( 'hammer.panstart', function ( evt ) {\r\n        console.log( \"START\" );\r\n        setHammerXY.call( that, that.$, evt );\r\n        var domEvt = evt.srcEvent;\r\n        slot( {\r\n            x: evt.x,\r\n            y: evt.y,\r\n            target: evt.target,\r\n            preventDefault: domEvt.preventDefault.bind( domEvt ),\r\n            stopPropagation: domEvt.stopImmediatePropagation.bind( domEvt )\r\n        } );\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onDown( register, slot, args ) {\r\n    var that = this;\r\n    register( \"touchstart\", function ( evt ) {\r\n        if ( !evt.changedTouches || evt.changedTouches.length < 1 ) return false;\r\n        var touch = evt.changedTouches[ 0 ];\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: touch.clientX - rect.left,\r\n                y: touch.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        return true;\r\n    } );\r\n    register( \"mousedown\", function ( evt ) {\r\n        var now = Date.now();\r\n        if ( now - that._touchstart < 350 ) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            return false;\r\n        }\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: evt.clientX - rect.left,\r\n                y: evt.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = 0;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction onUp( register, slot, args ) {\r\n    var that = this;\r\n    register( \"touchend\", function ( evt ) {\r\n        if ( !evt.changedTouches || evt.changedTouches.length < 1 ) return false;\r\n        var touch = evt.changedTouches[ 0 ];\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: touch.clientX - rect.left,\r\n                y: touch.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = Date.now();\r\n        return true;\r\n    } );\r\n    register( \"mouseup\", function ( evt ) {\r\n        if ( that._touchstart > 0 ) {\r\n            evt.preventDefault();\r\n            evt.stopPropagation();\r\n            return false;\r\n        }\r\n        var rect = that.$.getBoundingClientRect();\r\n        try {\r\n            slot( {\r\n                x: evt.clientX - rect.left,\r\n                y: evt.clientY - rect.top,\r\n                preventDefault: evt.preventDefault.bind( evt ),\r\n                stopPropagation: evt.stopPropagation.bind( evt )\r\n            } );\r\n        } catch ( ex ) {\r\n            console.error( ex );\r\n        }\r\n        that._touchstart = 0;\r\n        return true;\r\n    } );\r\n}\r\n\r\n\r\nfunction getEventNameForPrefix( text, prefix ) {\r\n    if ( text.substr( 0, prefix.length ) == prefix ) {\r\n        return text.substr( prefix.length );\r\n    }\r\n    return null;\r\n}\r\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}