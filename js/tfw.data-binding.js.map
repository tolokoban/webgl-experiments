{"version":3,"sources":["tfw.data-binding.js"],"names":["require","module","exports","_","D","X","intl","arguments","all","$","ParseUnit","parseUnit","Listeners","ID","converters","castFunction","v","castArray","Array","isArray","undefined","castBoolean","trim","toLowerCase","castColor","castDate","Date","castEnum","enumeration","lowerCaseEnum","map","Math","floor","length","idx","indexOf","castInteger","parseInt","Number","NaN","castFloat","parseFloat","castRegexp","RegExp","ex","console","error","castString","JSON","stringify","castStringArray","split","castUnit","u","isNaN","castValidator","rx","test","bind","propCast","caster","obj","att","val","hasSpecialGetter","value","event","setter","fire","getter","Object","defineProperty","get","set","configurable","enumerable","currentValue","readOnly","name","writtable","prop","propWidget","widget","widgetAttribute","propToggleClass","target","attribute","values","prefix","convertedValues","forEach","itm","key","addClass","element","removeClass","propAddClass","className","propRemoveClass","propArray","propBoolean","propColor","propDate","propEnum","propFunction","propInteger","propFloat","propRegexp","propString","propStringArray","propUnit","propValidator","srcObj","srcAtt","dstObj","dstAtt","options","Error","converter","lambda","add","extend","_def","_ext","_obj","callback","def","ext","out","parse","extKeys","keys","charAt","writable","txt"],"mappings":"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","sourcesContent":["/** @module tfw.data-binding */require( 'tfw.data-binding', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   \"use strict\";\r\n\r\n\r\n/**\r\n * @module\r\n *\r\n * Provide all the functions needed for data-binding.\r\n * JavaScript object have __attributes__.\r\n * Data-binding add a new comcept to objects: __properties__.\r\n * A property is an attribute you can listen for get and set operations.\r\n *\r\n * @example\r\n * var DB = require('tfw.data-binding');\r\n * DB.propAddClass( widget, 'visible', 'show' );\r\n */\r\nrequire(\"polyfill.string\");\r\nconst\r\n    $ = require(\"dom\"),\r\n    ParseUnit = require(\"tfw.css\").parseUnit,\r\n    Listeners = require(\"tfw.listeners\");\r\n\r\nconst\r\n    ID = '_tfw.data-binding_',\r\n    converters = {\r\n        castFunction: function(v) {\r\n            if (typeof v !== 'function') return null;\r\n            return v;\r\n        },\r\n        castArray: function(v) {\r\n            if (Array.isArray(v)) return v;\r\n            if (v === null || v === undefined) return [];\r\n            return [v];\r\n        },\r\n        castBoolean: function(v) {\r\n            if (typeof v === 'boolean') return v;\r\n            if (typeof v === 'string') {\r\n                v = v.trim().toLowerCase();\r\n                if (v === '0' || v === 'false' || v === 'no' || v === 'null' || v === 'undefined') {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n            if (typeof v === 'number') {\r\n                return v !== 0 ? true : false;\r\n            }\r\n            return null;\r\n        },\r\n        castColor: function(v) {\r\n            return \"\" + v;\r\n        },\r\n        castDate: function(v) {\r\n            if (typeof v === 'number' || typeof v === 'string')\r\n                return new Date(v);\r\n            if (v instanceof Date) return v;\r\n            return new Date();\r\n        },\r\n        castEnum: function(enumeration) {\r\n            var lowerCaseEnum = enumeration.map(toLowerCase);\r\n            return function(v) {\r\n                if (typeof v === 'number') {\r\n                    return enumeration[Math.floor(v) % enumeration.length];\r\n                }\r\n                if (typeof v !== 'string') return enumeration[0];\r\n                var idx = lowerCaseEnum.indexOf(v.trim().toLowerCase());\r\n                if (idx < 0) idx = 0;\r\n                return enumeration[idx];\r\n            };\r\n        },\r\n        castInteger: function(v) {\r\n            if (typeof v === 'number') {\r\n                return Math.floor(v);\r\n            }\r\n            if (typeof v === 'boolean') return v ? 1 : 0;\r\n            if (typeof v === 'string') {\r\n                return parseInt(v);\r\n            }\r\n            return Number.NaN;\r\n        },\r\n        castFloat: function(v) {\r\n            if (typeof v === 'number') {\r\n                return v;\r\n            }\r\n            if (typeof v === 'boolean') return v ? 1 : 0;\r\n            if (typeof v === 'string') {\r\n                return parseFloat(v);\r\n            }\r\n            return Number.NaN;\r\n        },\r\n        castRegexp: function(v) {\r\n            if (v instanceof RegExp) return v;\r\n            if (typeof v === 'string' && v.trim().length != 0) {\r\n                try {\r\n                    return new RegExp(v);\r\n                }\r\n                // Ignore Regular Expression errors.\r\n                catch (ex) {\r\n                    console.error(\"[castRegexp] /\" + v + \"/ \", ex);\r\n                }\r\n            };\r\n            return null;\r\n        },\r\n        castString: function(v) {\r\n            if (typeof v === 'string') return v;\r\n            if (v === undefined || v === null) return '';\r\n            return JSON.stringify(v);\r\n        },\r\n        castStringArray: function(v) {\r\n            if (Array.isArray(v)) return v;\r\n            if (v === null || v === undefined) return [];\r\n            if (typeof v === 'string') {\r\n                return v.split(',').map(trim);\r\n            }\r\n            return [JSON.stringify(v)];\r\n        },\r\n        castUnit: function(v) {\r\n            if (!v) return { v: 0, u: 'px' };\r\n            if (typeof v.v !== 'undefined') {\r\n                v.v = parseFloat(v.v);\r\n                if (isNaN(v.v)) return { v: 0, u: 'px' };\r\n                if (typeof v.u !== 'string') {\r\n                    v.u = 'px';\r\n                } else {\r\n                    v.u = v.u.trim().toLowerCase();\r\n                }\r\n                if (v.u === '') {\r\n                    v.u = 'px';\r\n                }\r\n                return { v: v.v, u: v.u };\r\n            }\r\n            if (typeof v === 'number') return { v: v, u: 'px' };\r\n            if (typeof v !== 'string') return { v: 0, u: 'px' };\r\n            return ParseUnit('' + v);\r\n        },\r\n        castValidator: function(v) {\r\n            if (typeof v === 'function') return v;\r\n            if (typeof v === 'boolean') return function() { return v; };\r\n            if (typeof v === 'string' && v.trim().length != 0) {\r\n                try {\r\n                    var rx = new RegExp(v);\r\n                    return rx.test.bind(rx);\r\n                }\r\n                // Ignore Regular Expression errors.\r\n                catch (ex) {\r\n                    console.error(\"[castValidator] /\" + v + \"/ \", ex);\r\n                }\r\n            };\r\n            return function() { return null; };\r\n        }\r\n    };\r\n\r\n/**\r\n * @param {any|function} val - Default value, or a specific getter (if `val` is a function).\r\n */\r\nfunction propCast(caster, obj, att, val) {\r\n    var hasSpecialGetter = typeof val === 'function';\r\n    if (typeof obj[ID] === 'undefined') obj[ID] = {};\r\n    obj[ID][att] = {\r\n        value: val,\r\n        event: new Listeners()\r\n    };\r\n    var setter;\r\n    if (typeof caster === 'function') {\r\n        setter = function(v) {\r\n            v = caster(v);\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if (hasSpecialGetter || obj[ID][att].value !== v) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire(v, obj, att);\r\n            }\r\n        };\r\n    } else {\r\n        setter = function(v) {\r\n            // If there is a special getter, any set will fire.\r\n            // Otherwise, we fire only if the value has changed.\r\n            if (hasSpecialGetter || obj[ID][att].value !== v) {\r\n                obj[ID][att].value = v;\r\n                obj[ID][att].event.fire(v, obj, att);\r\n            }\r\n        };\r\n    }\r\n    var getter = val;\r\n    if (!hasSpecialGetter) {\r\n        // Default getter.\r\n        getter = function() { return obj[ID][att].value; };\r\n    }\r\n    Object.defineProperty(obj, att, {\r\n        get: getter,\r\n        set: setter,\r\n        configurable: false,\r\n        enumerable: true\r\n    });\r\n    return exports.bind.bind(exports, obj, att);\r\n};\r\n\r\n/**\r\n * @export function fire\r\n *\r\n * Set a new value and fire the event even if the value has not changed.\r\n */\r\nexports.fire = function(obj, att, val) {\r\n    var currentValue = obj[att];\r\n    if (typeof val === 'undefined') val = currentValue;\r\n\r\n    obj[ID][att].value = val;\r\n    obj[ID][att].event.fire(obj[att], obj, att);\r\n};\r\n\r\n/**\r\n * @export function set\r\n *\r\n * Set a new value without firing any event.\r\n */\r\nexports.set = function(obj, att, val) {\r\n    if (typeof obj[ID] === 'undefined') obj[ID] = {};\r\n    if (typeof obj[ID][att] === 'undefined') obj[ID][att] = {};\r\n    obj[ID][att].value = val;\r\n};\r\n\r\n/**\r\n * @export function get\r\n *\r\n * Get a value without firing any event.\r\n */\r\nexports.get = function(obj, att) {\r\n    if (typeof obj[ID] === 'undefined') return undefined;\r\n    if (typeof obj[ID][att] === 'undefined') return undefined;\r\n    return obj[ID][att].value;\r\n};\r\n\r\n/**\r\n * @export function readOnly\r\n * @param {object} obj - Object to which we want to add a read only attribute.\r\n * @param {string} name - Attribute's name.\r\n * @param {function} value - Function to execute anytime someone gets the value of this attribute.\r\n * @param {any} value - Constatn value of this attribute.\r\n */\r\nexports.readOnly = function(obj, name, value) {\r\n    if (typeof value === 'function') {\r\n        Object.defineProperty(obj, name, {\r\n            get: value,\r\n            set: function() {},\r\n            configurable: false,\r\n            enumerable: true\r\n        });\r\n    } else {\r\n        Object.defineProperty(obj, name, {\r\n            value: value,\r\n            writtable: false,\r\n            configurable: false,\r\n            enumerable: true\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * Create a property on which we can bind another property.\r\n *\r\n * @param {object} obj - Object to which we want to add a property.\r\n * @param {string} att - Name of the attribute of `obj`.\r\n *\r\n */\r\nexports.prop = propCast.bind(null, null);\r\nexports.propWidget = function(obj, att, widget, widgetAttribute) {\r\n    if (typeof widgetAttribute === 'undefined') widgetAttribute = att;\r\n\r\n    if (typeof obj[ID] === 'undefined') obj[ID] = {};\r\n    obj[ID][att] = {\r\n        event: new Listeners()\r\n    };\r\n    exports.bind(widget, widgetAttribute, function(v) {\r\n        obj[ID][att].event.fire(v, obj, att);\r\n    });\r\n    Object.defineProperty(obj, att, {\r\n        get: function() {\r\n            return widget[widgetAttribute];\r\n        },\r\n        set: function(v) {\r\n            widget[widgetAttribute] = v;\r\n        },\r\n        configurable: false,\r\n        enumerable: true\r\n    });\r\n    return exports.bind.bind(exports, obj, att);\r\n};\r\n/**\r\n * @export @function propToggleClass\r\n * Create an enum attribute which toggles a CSS class when assigned.\r\n *\r\n * @param {array|object} values - If this is an array, we will convert\r\n * it  into an  object.  For instance `[\"show\",  \"hide\"]` will  become\r\n * `{show: \"show\", hide: \"hide\"}`.\r\n */\r\nexports.propToggleClass = function(target, attribute, values, prefix) {\r\n    if (typeof prefix !== 'string') prefix = '';\r\n    var convertedValues = {};\r\n    if (typeof values === 'string') {\r\n        convertedValues[values] = values;\r\n    } else if (Array.isArray(values)) {\r\n        values.forEach(function(itm) {\r\n            convertedValues[itm] = itm;\r\n        });\r\n    } else {\r\n        convertedValues = values;\r\n    }\r\n    return propCast(null, target, attribute)(function(v) {\r\n        var key, val;\r\n        for (key in convertedValues) {\r\n            val = convertedValues[key];\r\n            if (key == v) {\r\n                $.addClass(target.element, prefix + val);\r\n            } else {\r\n                $.removeClass(target.element, prefix + val);\r\n            }\r\n        }\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is added.\r\n * @example\r\n * DB.propAddClass( this, 'wide', 'fullscreen' );\r\n * DB.propAddClass( this, 'wide' );\r\n */\r\nexports.propAddClass = function(target, attribute, className) {\r\n    if (typeof className === 'undefined') className = attribute;\r\n    return propCast(converters.castBoolean, target, attribute)(function(v) {\r\n        if (v) $.addClass(target.element, className);\r\n        else $.removeClass(target.element, className);\r\n    });\r\n};\r\n/**\r\n * @export @function propAddClass\r\n * Create a boolean attribute that toggle a CSS class on the `element` attribute of `target`.\r\n * If the value id `true`, `className` is removed.\r\n * @example\r\n * DB.propRemoveClass( this, 'visible', 'hide' );\r\n */\r\nexports.propRemoveClass = function(target, attribute, className) {\r\n    if (typeof className === 'undefined') className = attribute;\r\n    return propCast(converters.castBoolean, target, attribute)(function(v) {\r\n        if (v) $.removeClass(target.element, className);\r\n        else $.addClass(target.element, className);\r\n    });\r\n};\r\nexports.propArray = propCast.bind(null, converters.castArray);\r\nexports.propBoolean = propCast.bind(null, converters.castBoolean);\r\nexports.propColor = propCast.bind(null, converters.castColor);\r\nexports.propDate = propCast.bind(null, converters.castDate);\r\nexports.propEnum = function(enumeration) {\r\n    return propCast.bind(null, converters.castEnum(enumeration));\r\n};\r\nexports.propFunction = propCast.bind(null, converters.castFunction);\r\nexports.propInteger = propCast.bind(null, converters.castInteger);\r\nexports.propFloat = propCast.bind(null, converters.castFloat);\r\nexports.propRegexp = propCast.bind(null, converters.castRegexp);\r\nexports.propString = propCast.bind(null, converters.castString);\r\nexports.propStringArray = propCast.bind(null, converters.castStringArray);\r\nexports.propUnit = propCast.bind(null, converters.castUnit);\r\nexports.propValidator = propCast.bind(null, converters.castValidator);\r\n\r\nexports.bind = function(srcObj, srcAtt, dstObj, dstAtt, options) {\r\n    if (typeof srcObj[ID] === 'undefined' || typeof srcObj[ID][srcAtt] === 'undefined') {\r\n        console.error(JSON.stringify(srcAtt) + \" is not a bindable property!\", {\r\n            srcObj: srcObj,\r\n            srcAtt: srcAtt,\r\n            dstObj: dstObj,\r\n            dstAtt: dstAtt,\r\n            options: options\r\n        });\r\n        throw Error(JSON.stringify(srcAtt) + \" is not a bindable property!\");\r\n    }\r\n\r\n    if (typeof options === 'undefined') options = {};\r\n    if (options.value) {\r\n        options.converter = function() {\r\n            return options.value;\r\n        };\r\n    }\r\n    var lambda = typeof dstObj === 'function' ? dstObj : function(v, obj, att) {\r\n        dstObj[dstAtt] = typeof options.converter === 'function' ? options.converter(v) : v;\r\n    };\r\n    srcObj[ID][srcAtt].event.add(lambda);\r\n\r\n    return options;\r\n};\r\n\r\n\r\n/**\r\n * @export.extend\r\n * @function extend\r\n * @param {object} _def - Default values for properties.\r\n * @param {object} _ext - Properties to override.\r\n * @param {object} _obj - DOM object whose properties belong.\r\n * @param {function}  callback -  Optional. Functioin  to call  when a\r\n * bindable property of `obj` changes.\r\n * @returns {object} A copy of `def` with values of `ext`.\r\n */\r\nexports.extend = function(_def, _ext, _obj, callback) {\r\n    const\r\n        def = _def || {},\r\n        ext = _ext || {},\r\n        obj = _obj || {},\r\n        out = JSON.parse(JSON.stringify(def)),\r\n        extKeys = Object.keys(ext);\r\n\r\n    extKeys.forEach((key) => {\r\n        if (key.charAt(0) === '$') return;\r\n        const val = ext[key];\r\n        if (typeof out[key] === 'undefined') {\r\n            console.error(`[tfw.data-binding.extend] Undefined argument: \"${key}\"!`);\r\n        } else {\r\n            out[key] = val;\r\n        }\r\n    });\r\n\r\n    if (typeof obj !== 'undefined') {\r\n        extKeys.forEach((key) => {\r\n            if (key.charAt(0) !== '$') return;\r\n            Object.defineProperty(obj, key, {\r\n                value: ext[key],\r\n                writable: false,\r\n                configurable: false,\r\n                enumerable: false\r\n            });\r\n        });\r\n        // Setting values.\r\n        Object.keys(out).forEach((key) => {\r\n            if (key.charAt(0) !== '$') {\r\n                try {\r\n                    obj[key] = out[key];\r\n                } catch (ex) {\r\n                    console.error(`Trying to extend property \"${key}\" of object `, obj);\r\n                    console.error(\"...with object \", out);\r\n                    console.error(\"...but got \", ex);\r\n                }\r\n            }\r\n        });\r\n        // General callback.\r\n        if (typeof callback === 'function') {\r\n            Object.keys(obj[ID]).forEach((key) => {\r\n                exports.bind(obj, key, callback);\r\n            });\r\n            callback();\r\n        }\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n\r\nfunction toLowerCase(txt) {\r\n    return txt.toLowerCase();\r\n}\r\n\r\nfunction trim(txt) {\r\n    return txt.trim();\r\n}\r\n\r\nexports.converters = converters;\r\n\r\n\r\nmodule.exports._ = _;\n})"]}