"use strict";require("x-widget",function(require,module){function Widget1(id,modName,args,attribs){"undefined"==typeof attribs&&(attribs={});try{var elem,module=require(modName),wdg=new module(args);if("function"==typeof wdg.element)elem=wdg.element();else if(wdg.element instanceof Node)elem=wdg.element;else if(wdg.$ instanceof Node)elem=wdg.$;else throw Error("Sorry, but \""+modName+"\" is not a widget nor a view!",wdg);var dst=document.getElementById(id);return dst&&dst.parentNode.replaceChild(elem,dst),elem.setAttribute("id",id),$.addClass(elem,attribs.class||""),register(id,wdg),wdg}catch(ex){throw console.error("[x-widget] Unable to create widget `"+modName+"`!"),console.error("[x-widget] id = ",id,", args = ",args),Error(ex)}}function Widget2(args){var id,elem=$.tag(args.elem);args.attr&&($.att(elem,args.attr),id=args.attr.id),Array.isArray(args.children)&&args.children.forEach(function(child){$.add(elem,child)});var key,val,wdg={};if(args.prop)for(key in args.prop)val=args.prop[key],Object.defineProperty(wdg,key,{value:val,writable:!1,configurable:!1,enumerable:!0});return Object.defineProperty(wdg,"element",{value:elem,writable:!1,configurable:!1,enumerable:!0}),"undefined"!=typeof id&&register(id,wdg),wdg}function register(id,wdg){widgets[id]=wdg;var mySlots=slots[id];return"undefined"!=typeof mySlots&&window.setTimeout(function(){mySlots.forEach(function(slot){slot(wdg)}),delete slots[id]}),"function"==typeof wdg.element?wdg.element:wdg.element||wdg}var _=function(){function _(){return X(D,arguments)}var D={en:{}},X=require("$").intl;return _.all=D,_}();var $=require("dom"),DB=require("tfw.data-binding"),widgets={},slots={},Widget=function(id,modName,args,attribs){try{return"string"==typeof id?Widget1.call(this,id,modName,args,attribs):Widget2.call(this,id)}catch(ex){throw console.error(ex),Error("Exception in "+modName+"("+JSON.stringify(args)+"):\n"+ex)}};Widget.template=function(attribs){var key,val,id,name="",args={};for(key in attribs)val=attribs[key],"name"==key?name=val:"id"==key?id=val:"$"==key.charAt(0)&&(args[key.substr(1)]=val);var module=require(name),wdg=new module(args);return id&&register(id,wdg),"function"==typeof wdg.element?wdg.element():wdg.element||wdg};Widget.getById=function(id){if(!widgets[id])throw Error("[x-widget.getById()] ID not found: "+id+"!");return widgets[id]},Widget.onWidgetCreation=function(id,slot){"undefined"==typeof widgets[id]?"undefined"==typeof slots[id]?slots[id]=[slot]:slots[id].push(slot):window.setTimeout(function(){slot(widgets[id])})},Widget.bind=function(id,attribs){var dstAtt,srcObj,srcAtt,bindings,slots,dstObj=widgets[id];for(dstAtt in attribs)bindings=attribs[dstAtt].B,Array.isArray(bindings)&&bindings.forEach(function(binding){if(srcObj=widgets[binding[0]],"undefined"==typeof srcObj)return void console.error("[x-widget:bind("+id+")] Trying to bind attribute \""+dstAtt+"\" of widget \""+id+"\" to the unexisting widget \""+binding[0]+"\"!");srcAtt=binding[1];try{if(2==binding.length)DB.bind(srcObj,srcAtt,dstObj,dstAtt);else{var value=binding[2];DB.bind(srcObj,srcAtt,function(){dstObj[dstAtt]=value})}}catch(ex){console.error("Binding error for widget `"+id+"`!",{ex:ex,binding:binding})}}),slots=attribs[dstAtt].S,Array.isArray(slots)&&slots.forEach(function(slot){var mod=APP,fct=slot;if(Array.isArray(slot)){try{mod=require(slot[0])}catch(ex){throw console.error("[x-widget:bind] Widget `"+id+"` can't require unexistent `"+slot[0]+"`: ",ex),ex}fct=slot[1]}if(fct=mod[fct],"function"==typeof fct)try{DB.bind(dstObj,dstAtt,fct)}catch(ex){console.error("Binding error for widget `"+id+"`!",{ex:ex,dstObj:dstObj,dstAtt:dstAtt,fct:fct,slot:slot})}else if(Array.isArray(slot))throw Error("[x-widget:bind]  Widget `"+id+"` use unexisting slot `"+slot[1]+"` of module `"+slot[0]+"`!");else throw Error("[x-widget:bind]  Widget `"+id+"` use unexisting slot `"+slot+"` of main module `APP`!")})},module.exports=Widget,module.exports._=_});
//# sourceMappingURL=x-widget.js.map