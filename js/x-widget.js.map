{"version":3,"sources":["x-widget.js"],"names":["require","module","Widget1","id","modName","args","attribs","elem","wdg","element","Node","$","Error","dst","document","getElementById","parentNode","replaceChild","setAttribute","addClass","class","register","ex","console","error","Widget2","tag","attr","att","Array","isArray","children","forEach","child","add","key","val","prop","Object","defineProperty","value","writable","configurable","enumerable","widgets","mySlots","slots","window","setTimeout","slot","_","X","D","arguments","intl","all","DB","Widget","call","JSON","stringify","template","name","charAt","substr","getById","onWidgetCreation","push","bind","dstAtt","srcObj","srcAtt","bindings","dstObj","B","binding","length","S","mod","APP","fct","exports"],"mappings":"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","sourcesContent":["/** @module x-widget */require( 'x-widget', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   /**\r\n * @example\r\n * \r\n * var W = require(\"x-widget\");\r\n * W({\r\n *   elem: \"div\",\r\n *   attr: {\"class\": \"black\"},\r\n *   prop: {\"$key\": \"menu\"},\r\n *   children: [\r\n *     \"This is the \",\r\n *     W({\r\n *       elem: \"b\",\r\n *       children: [\"menu\"]\r\n *     }),\r\n *     \"...\"\r\n *   ]\r\n * });\r\n */\r\n\"use strict\";\r\n\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\n\r\nvar widgets = {};\r\n// Used for `onWidgetCreation()`.\r\nvar slots = {};\r\n\r\n\r\nvar Widget = function(id, modName, args, attribs) {\r\n  try {\r\n  if (typeof id === 'string') return Widget1.call( this, id, modName, args, attribs );\r\n    else return Widget2.call( this, id );\r\n  }\r\n  catch( ex ) {\r\n    console.error( ex );\r\n    throw Error(\"Exception in \" + modName + \"(\" + JSON.stringify(args) + \"):\\n\" + ex);\r\n  }\r\n};\r\n\r\nfunction Widget1(id, modName, args, attribs ) {\r\n  if( typeof attribs === 'undefined' ) attribs = {};\r\n\r\n  try {\r\n    var module = require( modName );\r\n    var wdg = new module( args );\r\n    var elem;\r\n    if( typeof wdg.element === 'function' ) elem = wdg.element();\r\n    else if( wdg.element instanceof Node ) elem = wdg.element;\r\n    else if( wdg.$ instanceof Node ) elem = wdg.$;\r\n    else {\r\n      throw Error(\"Sorry, but \\\"\" + modName + \"\\\" is not a widget nor a view!\", wdg);\r\n    }\r\n    var dst = document.getElementById( id );\r\n    if (dst) {\r\n      // This widget does exist in the current DOM.\r\n      // We have to replace it.\r\n      dst.parentNode.replaceChild( elem, dst );\r\n    }\r\n    elem.setAttribute( 'id', id );\r\n    // Add classes defined in the containing element (`dst`).\r\n    $.addClass( elem, attribs.class || \"\" );\r\n    register( id, wdg );\r\n    return wdg;\r\n  }\r\n  catch (ex) {\r\n    console.error(\"[x-widget] Unable to create widget `\" + modName + \"`!\");\r\n    console.error(\"[x-widget] id = \", id, \", args = \", args);\r\n    throw Error(ex);\r\n  }\r\n};\r\n\r\nfunction Widget2(args) {\r\n  var id;\r\n  var elem = $.tag( args.elem );\r\n  if (args.attr) {\r\n    // Adding DOM element attributes.\r\n    $.att( elem, args.attr );\r\n    id = args.attr.id;\r\n  }\r\n\r\n  if (Array.isArray( args.children )) {\r\n    // Adding DOM element children.\r\n    args.children.forEach(function (child) {\r\n      $.add( elem, child );\r\n    });\r\n  }\r\n  // Converting into a widget.\r\n  var key, val;\r\n  var wdg = {};\r\n\r\n  if (args.prop) {\r\n    // Adding READ-ONLY properties to the widget.\r\n    for( key in args.prop ) {\r\n      val = args.prop[key];\r\n      Object.defineProperty( wdg, key, {\r\n        value: val, writable: false, configurable: false, enumerable: true\r\n      });\r\n    }\r\n  }\r\n  // Assigning the element to the widget.\r\n  Object.defineProperty( wdg, 'element', {\r\n    value: elem, writable: false, configurable: false, enumerable: true\r\n  });\r\n\r\n  if( typeof id !== 'undefined' ) {\r\n    // Registering the widget only if it as got an id.\r\n    register( id, wdg );\r\n  }\r\n  return wdg;\r\n}\r\n\r\nWidget.template = function( attribs ) {\r\n  var key, val, id, name = '', args = {};\r\n  for( key in attribs ) {\r\n    val = attribs[key];\r\n    if( key == 'name' ) {\r\n      name = val;\r\n    }\r\n    else if( key == 'id' ) {\r\n      id = val;\r\n    }\r\n    else if( key.charAt(0)=='$' ) {\r\n      args[key.substr( 1 )] = val;\r\n    }\r\n  }\r\n  var module = require( name );\r\n  var wdg = new module( args );\r\n  if( id ) {\r\n    register( id, wdg );\r\n  }\r\n\r\n  return typeof wdg.element === 'function' ? wdg.element() : (wdg.element || wdg);\r\n};\r\n\r\nfunction register( id, wdg ) {\r\n  widgets[id] = wdg;\r\n  var mySlots = slots[id];\r\n  if( typeof mySlots !== 'undefined' ) {\r\n    window.setTimeout(function() {\r\n      mySlots.forEach(function (slot) {\r\n        slot( wdg );\r\n      });\r\n      delete slots[id];\r\n    });\r\n  }\r\n  return typeof wdg.element === 'function' ? wdg.element : (wdg.element || wdg);\r\n};\r\n\r\nWidget.getById = function( id ) {\r\n  if( !widgets[id] ) throw Error( \"[x-widget.getById()] ID not found: \" + id + \"!\" );\r\n  return widgets[id];\r\n};\r\n\r\nWidget.onWidgetCreation = function( id, slot ) {\r\n  if( typeof widgets[id] === 'undefined' ) {\r\n    if( typeof slots[id] === 'undefined' ) slots[id] = [slot];\r\n    else slots[id].push( slot );\r\n  } else {\r\n    // Asynchronous call to the slot\r\n    window.setTimeout(\r\n      function() {\r\n        slot( widgets[id] );\r\n      }\r\n    );\r\n  }\r\n};\r\n\r\n/**\r\n * @example\r\n * var W = require(\"x-widget\");\r\n * W.bind('wdg.layout-stack0',{\"value\":{\"B\":[[\"btnNewTask\",\"action\"],[\"btnCancel\",\"action\"]]}});\r\n */\r\nWidget.bind = function( id, attribs ) {\r\n  // Destination object: the one on the attributes of which we want to bind.\r\n  var dstObj = widgets[id];\r\n  // Destination attribute name.\r\n  var dstAtt;\r\n  // Temporary variables to hold source object and attributes.\r\n  var srcObj, srcAtt;\r\n  // @example\r\n  // [\"btnNewTask\",\"action\",\"btnCancel\",\"action\"]\r\n  var bindings;\r\n  var slots;\r\n  // Index used to parse multiple bindings.\r\n  var idx;\r\n  for( dstAtt in attribs ) {\r\n    bindings = attribs[dstAtt].B;\r\n    if (Array.isArray( bindings )) {\r\n      // `binding` is an array of arrays.\r\n      // Subarrays have 2 or 3 elements.\r\n      // * ID if the source object\r\n      // * attribute to bind on\r\n      // * [optional] value  to use as  a constant. This  is the\r\n      // * case where  we just want  to set a constant  value as\r\n      // * soon as the source's attribute has changed.\r\n      bindings.forEach(function (binding) {\r\n        srcObj = widgets[binding[0]];\r\n        if( typeof srcObj === 'undefined' ) {\r\n          console.error( \"[x-widget:bind(\" + id + \")] Trying to bind attribute \\\"\"\r\n                         + dstAtt\r\n                         + \"\\\" of widget \\\"\" + id + \"\\\" to the unexisting widget \\\"\"\r\n                         + binding[0] + \"\\\"!\");\r\n          return;\r\n        }\r\n        srcAtt = binding[1];\r\n        try {\r\n          if (binding.length == 2) {\r\n            DB.bind( srcObj, srcAtt, dstObj, dstAtt );\r\n          } else {\r\n            var value = binding[2];\r\n            DB.bind( srcObj, srcAtt, function() {\r\n              dstObj[dstAtt] = value;\r\n            });\r\n          }\r\n        } catch( ex ) {\r\n          console.error(\"Binding error for widget `\" + id + \"`!\", {\r\n            ex: ex,\r\n            binding: binding\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    slots = attribs[dstAtt].S;\r\n    if (Array.isArray( slots )) {\r\n      // Each item is the name of a function to call when the value of this attribute changes.\r\n      // If the item is a `string`, the function is from the global `APP` object.\r\n      // Otherwise, the item must be an array with two children:\r\n      // the first one  is the module's name and  the second one\r\n      // id the name of the function.\r\n      // The slots are called with two arguments:\r\n      //  * the value and\r\n      //  * the object the attribute belongs.\r\n      slots.forEach(function (slot) {\r\n        var mod = APP;\r\n        var fct = slot;\r\n        if (Array.isArray( slot )) {\r\n          try {\r\n            mod = require(slot[0]);\r\n          } catch( ex ) {\r\n            console.error(\"[x-widget:bind] Widget `\" + id + \"` can't require unexistent `\"\r\n                          + slot[0] + \"`: \", ex);\r\n            throw( ex );\r\n          }\r\n          fct = slot[1];\r\n        }\r\n        fct = mod[fct];\r\n        if (typeof fct !== 'function') {\r\n          if( Array.isArray(slot) ) {\r\n            throw Error(\"[x-widget:bind]  Widget `\" + id + \"` use unexisting slot `\"\r\n                        + slot[1] + \"` of module `\" + slot[0] + \"`!\");\r\n          } else {\r\n            throw Error(\"[x-widget:bind]  Widget `\" + id + \"` use unexisting slot `\"\r\n                        + slot + \"` of main module `APP`!\");\r\n          }\r\n        } else {\r\n          try {\r\n            DB.bind( dstObj, dstAtt, fct );\r\n          } catch( ex ) {\r\n            console.error(\"Binding error for widget `\" + id + \"`!\", {\r\n              ex: ex,\r\n              dstObj: dstObj,\r\n              dstAtt: dstAtt,\r\n              fct: fct,\r\n              slot: slot\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n    }\r\n  }\r\n};\r\n\r\nmodule.exports = Widget;\r\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}