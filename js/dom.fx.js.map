{"version":3,"sources":["dom.fx.js"],"names":["require","module","exports","_","D","X","intl","arguments","all","$","DB","EMPTY_FUNC","ID","delay","window","setTimeout","Fx","name","_session","Object","defineProperty","prototype","value","writable","configurable","enumerable","_name","_tasks","_index","_started","_startTime","_onEnd","start","onEnd","end","$id","Date","now","next","call","session","length","that","tsk","_debug","console","info","label","args","bind","debug","addTask","task","push","log","msg","pause","exec","Array","slice","forEach","arg","ex","error","methodname","slot","apply","vanish","elem","ms","parseInt","isNaN","css","transition","opacity","wait","vanishAndDetach","detach","msOrElem","async","e","evt","itm","removeEventListener","addEventListener","Fullscreen","opts","Error","target","element","voidFunc","tools","onBeforeReplace","onAfterReplace","propBoolean","isFullScreen","fullscreenOn","fullscreenOff","terminate","rect","getBoundingClientRect","substitute","div","display","width","height","replace","styles","saveStyles","overlay","document","body","appendChild","left","top","addClass","r2","loadStyles","key","val","style"],"mappings":"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","sourcesContent":["/** @module dom.fx */require( 'dom.fx', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   \"use strict\";\r\n\r\nrequire( \"polyfill.promise\" );\r\n\r\nconst\r\n    $ = require( \"dom\" ),\r\n    DB = require( \"tfw.data-binding\" );\r\n\r\nconst EMPTY_FUNC = function () {\r\n    // Do nothing.\r\n};\r\n\r\n// Unique ID.\r\nlet ID = 1;\r\n\r\nconst delay = window.setTimeout;\r\n\r\n/**\r\n * @class Fx\r\n * @param {string} name - Optional name of this animation chain.\r\n */\r\nfunction Fx( name ) {\r\n    // Because it is  possible to call `end()` before  the sequence is\r\n    // over, we need  to know in what  session we are. This  way, if a\r\n    // callback is called after the end,  it can know that it must not\r\n    // execute the next task.\r\n    this._session = {};\r\n    // A name can be defined for debug purpose, but it is not used right now.\r\n    Object.defineProperty( Fx.prototype, 'name', {\r\n        value: name,\r\n        writable: false,\r\n        configurable: true,\r\n        enumerable: true\r\n    } );\r\n    this._name = name;\r\n    // Sequence of  tasks. A task  is a function with  two parameters:\r\n    // the `next()` function and a  boolean `async` which tells you if\r\n    // your are allowed to call async functions.\r\n    // When  a task  is  called in  the `end()`  function,  it is  not\r\n    // allowed to call async functions.\r\n    this._tasks = [];\r\n    // Index of the current task.\r\n    this._index = 0;\r\n    this._started = false;\r\n    this._startTime = 0;\r\n    this._onEnd = EMPTY_FUNC;\r\n}\r\n\r\n/**\r\n * @param {function} _onEnd - Function to call as soon as the animation ends.\r\n * @returns {undefined}\r\n */\r\nFx.prototype.start = function ( _onEnd ) {\r\n    const onEnd = typeof _onEnd !== \"undefined\" ? _onEnd : EMPTY_FUNC;\r\n    if ( this._started ) this.end();\r\n    this._onEnd = onEnd;\r\n    this._started = true;\r\n    this._index = 0;\r\n    this._session = { $id: ID++ };\r\n    this._startTime = Date.now();\r\n    next.call( this, this._session );\r\n};\r\n\r\n/**\r\n * Next step of the animation.\r\n * @this Fx\r\n * @param {object} session - ``{ $id }\r\n * @returns {undefined}\r\n */\r\nfunction next( session ) {\r\n    if ( session !== this._session ) return;\r\n    if ( this._index >= this._tasks.length ) {\r\n        this._index = 0;\r\n        this._started = false;\r\n        delete this._session;\r\n        this._onEnd( this );\r\n        return;\r\n    }\r\n\r\n    const\r\n        that = this,\r\n        tsk = this._tasks[ this._index++ ];\r\n    if ( this._debug ) {\r\n        console.info(\r\n            `[dom.fx] tsk[${this._index - 1}]: `, tsk.label,\r\n            `(${Date.now() - this._startTime} ms)`, tsk.args, session\r\n        );\r\n    }\r\n    tsk( function () {\r\n        delay( next.bind( that, session ) );\r\n    }, true );\r\n}\r\n\r\nFx.prototype.end = function () {\r\n    if ( !this._started ) return this;\r\n    var that = this;\r\n    this._started = false;\r\n    delete this._session;\r\n    while ( this._index < this._tasks.length ) {\r\n        var tsk = this._tasks[ this._index++ ];\r\n        if ( that._debug ) {\r\n            console.info( \"[dom.fx.end] tsk[\" + ( this._index - 1 ) + \"]: \", tsk.label, tsk.args );\r\n        }\r\n        tsk( EMPTY_FUNC, false );\r\n    }\r\n    this._onEnd( this );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @member Fx.debug\r\n * @param value\r\n */\r\nFx.prototype.debug = function ( value ) {\r\n    this.addTask( function ( next ) {\r\n        this._debug = value ? true : false;\r\n        next();\r\n    } );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.addTask = function ( task, label, args ) {\r\n    task.label = label;\r\n    task.args = args;\r\n    this._tasks.push( task );\r\n    return this;\r\n};\r\n\r\n/**\r\n * @return void\r\n */\r\nFx.prototype.log = function ( msg ) {\r\n    this.addTask( function ( next ) {\r\n        console.log( \"[dom.fx]\", msg );\r\n        next();\r\n    }, 'log' );\r\n    return this;\r\n};\r\n\r\n/**\r\n * Stop execution of the animation until end() has been called.\r\n */\r\nFx.prototype.pause = function () {\r\n    this.addTask( EMPTY_FUNC, 'pause' );\r\n    return this;\r\n};\r\n\r\nFx.prototype.exec = function () {\r\n    var args = Array.prototype.slice.call( arguments );\r\n    this.addTask( function ( next, session ) {\r\n        args.forEach( function ( arg ) {\r\n            try {\r\n                if ( typeof arg === 'function' ) arg( session );\r\n                else console.log( '[dom.fx]', arg );\r\n            } catch ( ex ) {\r\n                console.error( ex );\r\n            }\r\n        } );\r\n        next();\r\n    }, 'exec', args );\r\n    return this;\r\n};\r\n\r\n[\r\n  'css', 'addClass', 'removeClass', 'toggleClass', 'detach',\r\n  'saveStyle', 'restoreStyle', 'add', 'removeAtt', 'replace'\r\n].forEach( function ( methodname ) {\r\n    var slot = $[ methodname ];\r\n    Fx.prototype[ methodname ] = function () {\r\n        var args = Array.prototype.slice.call( arguments );\r\n        this.addTask( function ( next ) {\r\n            slot.apply( $, args );\r\n            next();\r\n        }, methodname, args );\r\n        return this;\r\n    };\r\n} );\r\n\r\n\r\n/**\r\n * @member Fx.vanish\r\n * @param elem, ms\r\n */\r\nFx.prototype.vanish = function ( elem, ms ) {\r\n    ms = parseInt( ms );\r\n    if ( isNaN( ms ) ) ms = 300;\r\n    return this.css( elem, { transition: \"none\" } )\r\n        .css( elem, { transition: \"opacity \" + ms + \"ms\", opacity: 0 } )\r\n        .wait( ms );\r\n};\r\n\r\nFx.prototype.vanishAndDetach = function ( elem, ms ) {\r\n    ms = parseInt( ms );\r\n    if ( isNaN( ms ) ) ms = 300;\r\n    return this.vanish( elem, ms ).detach( elem );\r\n};\r\n\r\n/**\r\n * @member Fx.wait\r\n * @param ms\r\n */\r\nFx.prototype.wait = function ( msOrElem ) {\r\n    var that = this;\r\n    var args = Array.prototype.slice.call( arguments );\r\n\r\n    if ( typeof msOrElem === 'undefined' ) msOrElem = 0;\r\n    if ( typeof msOrElem === 'number' ) {\r\n        this.addTask( function ( next, async ) {\r\n            if ( async ) {\r\n                delay( next, msOrElem );\r\n            }\r\n        }, 'wait', args );\r\n    } else {\r\n        this.addTask( function ( next, async ) {\r\n            if ( async ) {\r\n                var e = $( msOrElem );\r\n                var slot = function ( evt ) {\r\n          [ 'transitionend', 'oTransitionEnd', 'webkitTransitionEnd' ].forEach( function ( itm ) {\r\n                        e.removeEventListener( itm, slot );\r\n                    } );\r\n                    next();\r\n                };\r\n        [ 'transitionend', 'oTransitionEnd', 'webkitTransitionEnd' ].forEach( function ( itm ) {\r\n                    e.addEventListener( itm, slot );\r\n                } );\r\n            }\r\n        }, 'wait', args );\r\n    }\r\n    return this;\r\n};\r\n\r\n\r\nmodule.exports = function ( name ) {\r\n    return new Fx( name );\r\n};\r\n\r\n\r\n/**\r\n * @module dom.fx\r\n *\r\n * @description\r\n * All the animation effects you can do on DOM elements.\r\n *\r\n * @example\r\n * var mod = require('dom.fx');\r\n */\r\n\r\n\r\n/**\r\n * @export {function} fullscreen\r\n * @param opts\r\n * * __target__: target DOM element.\r\n *\r\n * @return {object}\r\n * * __value__    {boolean}:    If    `true`    the    element    goes\r\n fullscreen. Otherwise, it returns to its initial position.\r\n */\r\nmodule.exports.Fullscreen = function ( opts ) {\r\n    if ( typeof opts === 'undefined' ) {\r\n        throw Error( \"[dom.fx:fullscreen] Missing argument!\" );\r\n    }\r\n    if ( typeof opts.target === 'undefined' ) {\r\n        throw Error( \"[dom.fx:fullscreen] Missing `opts.target`!\" );\r\n    }\r\n    if ( typeof opts.target.element === 'function' ) opts.target = opts.target.element();\r\n    if ( typeof opts.target.element !== 'undefined' ) opts.target = opts.target.element;\r\n\r\n    var voidFunc = function () {};\r\n    var tools = {\r\n        onBeforeReplace: typeof opts.onBeforeReplace === 'function' ? opts.onBeforeReplace : voidFunc,\r\n        onAfterReplace: typeof opts.onAfterReplace === 'function' ? opts.onAfterReplace : voidFunc\r\n    };\r\n    DB.propBoolean( this, 'value' )( function ( isFullScreen ) {\r\n        if ( isFullScreen ) {\r\n            fullscreenOn( opts.target, tools );\r\n        } else {\r\n            fullscreenOff( opts.target, tools );\r\n        }\r\n    } );\r\n};\r\n\r\nfunction fullscreenOn( target, tools ) {\r\n    if ( tools.terminate ) tools.terminate();\r\n\r\n    var rect = target.getBoundingClientRect();\r\n    console.info( \"[dom.fx] rect=...\", rect );\r\n    var substitute = $.div();\r\n    $.css( substitute, {\r\n        display: 'inline-block',\r\n        width: rect.width + \"px\",\r\n        height: rect.height + \"px\"\r\n    } );\r\n\r\n    tools.onBeforeReplace( target );\r\n    $.replace( substitute, target );\r\n    tools.onAfterReplace( target );\r\n\r\n    tools.substitute = substitute;\r\n    tools.styles = saveStyles( target );\r\n    tools.overlay = $.div( 'dom-fx-fullscreen' );\r\n    document.body.appendChild( tools.overlay );\r\n    tools.overlay.appendChild( target );\r\n    $.css( target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    } );\r\n    $.addClass( target, 'dom-fx-fullscreen-target' );\r\n\r\n    delay( function () {\r\n        var r2 = tools.overlay.getBoundingClientRect();\r\n        $.css( target, {\r\n            left: '20px',\r\n            top: '20px',\r\n            width: ( r2.width - 40 ) + 'px',\r\n            height: ( r2.height - 40 ) + 'px'\r\n        } );\r\n    } );\r\n}\r\n\r\nfunction fullscreenOff( target, tools ) {\r\n    var rect = tools.substitute.getBoundingClientRect();\r\n    $.css( target, {\r\n        left: rect.left + 'px',\r\n        top: rect.top + 'px',\r\n        width: rect.width + 'px',\r\n        height: rect.height + 'px'\r\n    } );\r\n    tools.terminate = function () {\r\n        $.detach( tools.overlay );\r\n\r\n        tools.onBeforeReplace( target );\r\n        $.replace( target, tools.substitute );\r\n        tools.onAfterReplace( target );\r\n\r\n        loadStyles( target, tools.styles );\r\n        delete tools.terminate;\r\n    };\r\n\r\n    delay( tools.terminate, 200 );\r\n}\r\n\r\nfunction saveStyles( element ) {\r\n    var styles = {};\r\n    var key, val;\r\n    for ( key in element.style ) {\r\n        val = element.style[ key ];\r\n        styles[ key ] = val;\r\n    }\r\n    console.info( \"[dom.fx] styles=...\", styles );\r\n    return styles;\r\n}\r\n\r\nfunction loadStyles( element, styles ) {\r\n    for ( var key in styles ) {\r\n        element.style[ key ] = styles[ key ];\r\n    }\r\n}\r\n\r\n\r\nmodule.exports._ = _;\n})"]}