{"version":3,"sources":["wdg.showhide.js"],"names":["require","module","exports","_","D","X","intl","arguments","all","$","DB","Icon","Focusable","Showhide","opts","that","icon","content","size","label","tag","head","div","body","elem","evt","keyCode","value","console","info","propBoolean","v","addClass","removeClass","window","setTimeout","propString","textContent","propUnit","unit","style","maxHeight","u","prop","clear","Array","isArray","forEach","itm","add","propRemoveClass","extend","visible","wide","simple","focus","reverseValue","on","append","item","push","prepend","insertBefore","childNodes","prototype"],"mappings":"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","sourcesContent":["/** @module wdg.showhide */require( 'wdg.showhide', function(require, module, exports) { var _=function(){var D={\"en\":{}},X=require(\"$\").intl;function _(){return X(D,arguments);}_.all=D;return _}();\r\n   /**\r\n * @module tfw.view.label\r\n *\r\n * @description\r\n * * __label__: Text to display as title.\r\n * * __value__: If true, the content is visible.\r\n * * __content__: Array of the embeded elements.\r\n * @param {boolean} opts.simple\r\n *\r\n * @example\r\n * var mod = require('wdg.showhide');\r\n */\r\n\r\nvar $ = require(\"dom\");\r\nvar DB = require(\"tfw.data-binding\");\r\nvar Icon = require(\"wdg.icon\");\r\nvar Focusable = require(\"tfw.focusable\");\r\n\r\n\r\nfunction Showhide( opts ) {\r\n  var that = this;\r\n\r\n  var icon = new Icon({content: \"tri-right\", size: \"24px\"});\r\n  var label = $.tag('span', 'label');\r\n  var head = $.div('head', [icon, label]);\r\n  var body = $.div('body', 'thm-bg0');\r\n  var elem = $.elem( this, 'div', 'wdg-showhide', 'thm-ele2', [head, body] );\r\n\r\n  Focusable( this, function(evt) {\r\n    switch( evt.keyCode ) {\r\n    case 13:\r\n    case 32:\r\n      that.value = !that.value;\r\n      break;\r\n    }\r\n    console.info(\"[wdg.showhide] evt=\", evt);\r\n  });\r\n\r\n  DB.propBoolean(this, 'value')(function(v) {\r\n    if (v) {\r\n      $.addClass( elem, 'show' );\r\n      $.removeClass( elem, 'fade-in' );\r\n      window.setTimeout(function() {\r\n        $.addClass( elem, 'fade-in' );\r\n      });\r\n    }\r\n    else $.removeClass( elem, 'show' );\r\n  });\r\n  DB.propBoolean(this, 'simple')(function(v) {\r\n    if (v) {\r\n      $.addClass( elem, 'simple' );\r\n      $.removeClass( elem, 'thm-ele2' );\r\n      $.removeClass( head, 'thm-bgPD' );\r\n    } else {\r\n      $.removeClass( elem, 'simple' );\r\n      $.addClass( elem, 'thm-ele2' );\r\n      $.addClass( head, 'thm-bgPD' );\r\n    }\r\n  });\r\n  DB.propString(this, 'label')(function(v) {\r\n    label.textContent = v;\r\n  });\r\n  DB.propUnit(this, 'maxHeight')(function(unit) {\r\n    if( unit.v <= 0 ) {\r\n      // The size of the widget is determined by the size of its content.\r\n      body.style.maxHeight = 'none';\r\n    } else {\r\n      // Set a max-height and activate scrolling.\r\n      body.style.maxHeight = unit.v + unit.u;\r\n    }\r\n  });\r\n  DB.prop(this, 'content')(function(v) {\r\n    $.clear( body );\r\n    if (Array.isArray( v )) {\r\n      v.forEach(function (itm) {\r\n        $.add( body, itm );\r\n      });\r\n    } else if (typeof v !== 'undefined' && v !== null){\r\n      $.add( body, v );\r\n    }\r\n  });\r\n  DB.propRemoveClass(this, 'wide', 'inline');\r\n  DB.propRemoveClass(this, 'visible', 'hide');\r\n\r\n  opts = DB.extend({\r\n    value: true, label: '', content: null, maxHeight: null,\r\n    visible: true, wide: true, simple: false, focus: false\r\n  }, opts, this );\r\n\r\n  // Toggle display on Tap.\r\n  function reverseValue() {\r\n    that.value = !that.value;\r\n    that.focus = true;\r\n  }\r\n  $.on( head, reverseValue);\r\n\r\n  this.append = function( item ) {\r\n    if (!Array.isArray(that.content)) that.content = [];\r\n    that.content.push( item );\r\n    $.add( body, item );\r\n    return that;\r\n  };\r\n\r\n  this.prepend = function( item ) {\r\n    if (!Array.isArray(that.content)) that.content = [];\r\n    that.content.push( item );\r\n    body.insertBefore( item, body.childNodes[0] );\r\n    return that;\r\n  };\r\n}\r\n\r\n\r\n/**\r\n * @return void\r\n */\r\nShowhide.prototype.clear = function() {\r\n  this.content = [];\r\n  return this;\r\n};\r\n\r\n\r\n/**\r\n * @class tfw.view.label\r\n * @param {string} value  - Text to display. If this  text starts with\r\n * `<html>`, it is parsed as HTML code.\r\n */\r\nmodule.exports = Showhide;\r\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}